<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0"
           xmlns:jpa="http://aries.apache.org/xmlns/jpa/v1.1.0"
           xmlns:tx="http://aries.apache.org/xmlns/transactions/v1.0.0"
           xmlns:camel="http://camel.apache.org/schema/blueprint"
           xsi:schemaLocation="
             http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
             http://aries.apache.org/xmlns/transactions/v1.0.0
             http://aries.apache.org/xmlns/jpa/v1.1.0
                http://camel.apache.org/schema/blueprint/cxf/ http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">

    <!-- Requests DAO -->
    <bean id="invoiceDAO" class="com.estafet.invoicesystem.impl.InvoiceDAOImpl">
        <jpa:context unitname="invoice-unit" property="entityManager"/>
        <tx:transaction method="*" value="Required"/>
    </bean>
    <service id="invoiceDAOService" interface="com.estafet.invoicesystem.InvoiceDAO" ref="invoiceDAO"/>

    <!-- Requests Diagnostic DAO -->
    <!--<bean id="taxDAO" class="com.estafet.invoicesystem.impl.TaxDAOImpl">
        <jpa:context unitname="invoice-unit" property="entityManager"/>
        <tx:transaction method="*" value="Required"/>
    </bean>
    <service id="taxDAOService" interface="com.estafet.invoicesystem.api.TaxDAO" ref="taxDAO"/>-->
    <!--<camelContext trace="true" xmlns="http://camel.apache.org/schema/spring">-->
        <!--<routeBuilder ref="myroute"/>-->
    <!--</camelContext>-->
    <!--<camel:camelContext trace="true">
        <camel:routeBuilder ref="myroute"/>
    </camel:camelContext>

    <bean id="myroute" class="com.estafet.invoicesystem.routebuilders.FileToJpaRoute"/>

    <bean id="jpa" class="org.apache.camel.component.jpa.JpaComponent">
        <jpa:unit unitname="persistenceUnit" property="entityManagerFactory"/>
        <property name="transactionManager" ref="transactionManager"/>
    </bean>

    <reference id="jtaTransactionManager" interface="javax.transaction.TransactionManager"/>

    <bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager">
        <argument ref="jtaTransactionManager"/>
    </bean>


    <bean id="PROPAGATION_REQUIRED" class="org.apache.camel.spring.spi.SpringTransactionPolicy">
        <property name="transactionManager" ref="transactionManager"/>
    </bean>-->
    <!--<bean id="jpaTxManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
    </bean>

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="persistenceUnit"/>
    </bean>

    <bean id="jpa" class="org.apache.camel.component.jpa.JpaComponent">
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
        <property name="transactionManager" ref="jpaTxManager"/>
    </bean>-->


</blueprint>